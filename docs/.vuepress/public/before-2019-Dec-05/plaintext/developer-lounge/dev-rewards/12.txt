==============================================================
Guild: Komodo
Channel: dev-rewards
Topic: A channel to discuss claiming Komodo's 5.1% rewards.
Messages: 100
Range: before 05-Dec-19 12:00 AM
==============================================================

[04-Jan-19 10:57 PM] lukechilds#2707
@PTYX That's odd, the Magnum CTO has been talking to me directly on the Ledger Dev Slack asking for help and said he hasn't been able to sign an overwinter TX yet, I managed it by just reading through the source and have been working with the Ledger CTO to fix the remaining bugs.

Also there is no PR submitted by Magnum regarding to overwinter support as you claim: https://github.com/LedgerHQ/ledger-app-btc/pulls?utf8=%E2%9C%93&q=is%3Apr+sort%3Aupdated-desc

And the current overwinter branch has no one's work in it apart from the Ledger CTOs and my own: https://github.com/LedgerHQ/ledger-app-btc/compare/zcash_sapling

{Embed}
https://github.com/LedgerHQ/ledger-app-btc/pulls?utf8=%E2%9C%93&q=is%3Apr+sort%3Aupdated-desc
LedgerHQ/ledger-app-btc
Bitcoin wallet application for Ledger Blue and Nano S - LedgerHQ/ledger-app-btc
https://avatars0.githubusercontent.com/u/9784193?s=400&v=4

{Embed}
https://github.com/LedgerHQ/ledger-app-btc/compare/zcash_sapling
LedgerHQ/ledger-app-btc
Bitcoin wallet application for Ledger Blue and Nano S - LedgerHQ/ledger-app-btc
https://avatars0.githubusercontent.com/u/9784193?s=400&v=4

[04-Jan-19 10:58 PM] lukechilds#2707

{Attachments}
https://cdn.discordapp.com/attachments/502811530002300939/530882652874473492/Screen_Shot_2019-01-05_at_5.png

[04-Jan-19 10:59 PM] lukechilds#2707
Can you back up your claim at all?

Because as far as I can tell, I've been working with Ledger to get this functionality working, and you/Magnum seem to be trying to take credit for it (again)

[04-Jan-19 11:01 PM] lukechilds#2707
@Deleted User 

```
EmmanuelYesterday at 20:20
That means that we'll have it first, before Zcash?
```

Zcash and Komodo share the same codebase. Once they have overwinter/sapling support working they'll likely roll it out to both coins at the same time

[04-Jan-19 11:15 PM] actionslacks#4072
It's not rocket science :trollface:

{Reactions}
trollface abusedsmily 

[04-Jan-19 11:23 PM] actionslacks#4072
It's speaks pretty highly of @lukechilds  that he is willing to go back and actually help the guy who dismissed his efforts in the first place. I hope you guys can come to a resolution on this.

[04-Jan-19 11:26 PM] lukechilds#2707
It's not rocket science.

Until you decide to stop ripping off other peoples work and actually try to implement it on your own. Then all of a sudden it becomes much harder :trollface:

[04-Jan-19 11:27 PM] lukechilds#2707
But yeah @actionslacks we're all in this together, regardless of past history, if someone asks a question and I know the answer I will help them. I don't think that speaks highly of me, it just means I'm not a dick.

[04-Jan-19 11:28 PM] lukechilds#2707
I've vocally disagreed with @jl777c on a lot of issues, but I still respect him and he's still given me a huge amount of help whenever I've come to him with questions.

[05-Jan-19 12:00 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
_buys a glorified USB stick, learns C, and proves that even the village idiot can form a tx_

[05-Jan-19 12:03 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
_gets overwhelmed and confused by models and options and says "fek it"_

[05-Jan-19 12:57 AM] Mylo#8306
My village-idiot-don't-be-a-dick license will be in full effect on the firmware of that usb stick @ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢

{Reactions}
trollface (2) 

[05-Jan-19 04:25 AM] lukechilds#2707
I wish they were open source too, but I have no problem with them being closed source, as long as they provide attribution to MIT licensed code they decide to include.

[05-Jan-19 07:36 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
The solution to all of these problems is buy a device that doesn't have 125 repos some of which have had support for months and some of which still don't work
>Dear Ledger, unify your code or fek off
It's sad to see this much shit over a device that can't get its shit together

[05-Jan-19 08:43 AM] actionslacks#4072
the world is a constant train wreck of happenstance.

[05-Jan-19 08:45 AM] actionslacks#4072
crypto is only a magnifying glass, I wouldn't ever volunteer to sell a hardware wallet to cater to the menagerie of scams and poorly designed protocols out there. If nothing else, ledger gets a badge for bravery

[05-Jan-19 08:46 AM] actionslacks#4072
for all anybody knows ther is a back door to every single one of em

[05-Jan-19 09:08 AM] actionslacks#4072
@ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢  what exact model of mb did u buy when u got jacked? cause now I'm paranoid and building a win10 box

[05-Jan-19 09:10 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
the mb was irrelevant; it was a worm embedded in an installer that I downloaded via torrents

[05-Jan-19 09:11 AM] actionslacks#4072
so you torrent your hardware drivers?

[05-Jan-19 09:12 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
no, I 99% narrowed it down to being a torrent I downloaded for vmware instead of getting the legit file

[05-Jan-19 09:13 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
no reason to be paranoid, don't do dumb shit and you don't get dumb results

[05-Jan-19 09:13 AM] actionslacks#4072
play stupid games, get stupid prizes

{Reactions}
ğŸ˜„ 

[05-Jan-19 09:13 AM] actionslacks#4072
I get it

[05-Jan-19 09:13 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
that too ğŸ˜›

[05-Jan-19 09:14 AM] actionslacks#4072
well I know you're not pissing in a bucket yet, so for that, congrats

[05-Jan-19 09:15 AM] actionslacks#4072
crusty outer shell aside, Thanks for the contributions

{Reactions}
ğŸ‘ğŸ½ 

[05-Jan-19 09:16 AM] actionslacks#4072
!arrrtip @ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢ 10

[05-Jan-19 09:16 AM] ARRR TipBot#1743

{Embed}
TipBot
@actionslacks (actionslacks#4072)
You tipped @ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢ **9.9999 ARRR**
A network fee of 0.0001 ARRR was deducted from the amount.
This operation is pending. You will be notified when when it has finished.

{Reactions}
â¤ 

[07-Jan-19 03:32 PM] Mylo#8306
hey @lukechilds got a question by-proxy:   would it be hard to have a KMD ledger app compatiable with smart phones after ledger goes live with your updates?   e.g. https://www.ledger.com/pages/ledger-nano-x

{Embed}
https://www.ledger.com/pages/ledger-nano-x
Ledger Nano X - Secure your crypto
Make sure your crypto assets are safe anywhere you go with our most advanced hardware wallet yet. The Ledger Nano X is a bluetooth enabled secure device that stores your private keys and offers an easy-to-use experience for crypto owners.
https://cdn.shopify.com/s/files/1/2974/4858/files/good_square_200x.png?v=1533838574

[08-Jan-19 05:52 AM] lukechilds#2707
@Mylo I've actually been discussing this with the Ledger team internally.

I can't confirm for definite but I'm fairly sure that I should be able to get our Ledger reward claiming app working with both Nano S and Nano X on both Desktop and mobile.

{Reactions}
shexy 

[08-Jan-19 05:53 AM] lukechilds#2707
although this would be limited to browsers that support Web Bluetooth which is currently only Chrome for Android on smartphones

[08-Jan-19 05:53 AM] lukechilds#2707
so no iOS support

[08-Jan-19 05:54 AM] lukechilds#2707
but we could add iOS support by building a native app if there is enough interest and I can get funding

[08-Jan-19 05:54 AM] lukechilds#2707
but that's a load more work and I don't think it's a good option

[08-Jan-19 05:55 AM] lukechilds#2707
either Apple should pull their finger out and support Web Bluetooth in which case it will just work, or iOS users will have to use a desktop to claim

[08-Jan-19 08:19 AM] Mylo#8306
Probably goes against NIH and  ğŸ pay

[08-Jan-19 08:20 AM] Mylo#8306
Thx for reply

[08-Jan-19 11:27 PM] lukechilds#2707
Np

[08-Jan-19 11:27 PM] lukechilds#2707
Also worth noting, I think the Nano X should be usable over USB in the exact same way the Nano S is

[08-Jan-19 11:28 PM] lukechilds#2707
So if people are looking to upgrade then it should just work with no changes

[08-Jan-19 11:28 PM] lukechilds#2707
Additional changes will only be required for Bluetooth/mobile support

[08-Jan-19 11:28 PM] lukechilds#2707
Obviously that's untested though, just going on what I've heard from Ledger devs

{Reactions}
ğŸ‘ 

[11-Jan-19 10:14 AM] lukechilds#2707
@ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢ would you be able to take a look at this?

[11-Jan-19 10:15 AM] lukechilds#2707
from your last message:

```
ComputerGenie ãƒ„03/01/2019
000000000000000000000000000000cfd72d5c
looks like it needs to be
cfd72d5c000000000000000000000000000000
if cfd72d5c is locktime
where it used to be
hashOutputs (32-byte hash)
nLockTime of the transaction (4-byte little endian)

it's now
hashOutputs (32-byte hash)
nLockTime of the transaction (4-byte little endian)
nExpiryHeight of the transaction (4-byte little endian)
valueBalance of the transaction (8-byte little endian)
```

[11-Jan-19 10:15 AM] lukechilds#2707
I have a function that appears to unmangle the transactions from the Ledger

[11-Jan-19 10:16 AM] lukechilds#2707
```
const unmangleTransaction = rawtx => {
  const endLength = 38;
  const nLocktimeLength = 8;
  const endChunk = rawtx.slice(-endLength);
  const nLockTime = endChunk.slice(-nLocktimeLength);
  const fixedEndChunk = nLockTime + endChunk.slice(0, -nLocktimeLength);
  const fixedRawtx = rawtx.slice(0, -endLength) + fixedEndChunk

  return fixedRawtx;
};
```

[11-Jan-19 10:16 AM] lukechilds#2707
which seems to work

[11-Jan-19 10:17 AM] lukechilds#2707
```
rawtx
"0400008085202f890183a7fe66cc439a8e33bb63ad08dbb74acdcb68a902373398254d21d924f3c243000000006b483045022100c1bd5c4507fb3482e975052502c3b2d3bb67462ba6f1c3a417067d98082774700220439883fcad68f50014c824e311760b3d48708406153d57fe0a94f7a5deb3e1c101210242e1461aa67a0c21ba4ed65eec81b1ee3f9460cac030f3b9e0cd1da748c4ac01ffffffff0157e0673c000000001976a914dde900f38b45dad3718944fc7e949482d43e76f788ac0000000000000000000000000000008266385c"

unmangleTransaction(rawtx)
"0400008085202f890183a7fe66cc439a8e33bb63ad08dbb74acdcb68a902373398254d21d924f3c243000000006b483045022100c1bd5c4507fb3482e975052502c3b2d3bb67462ba6f1c3a417067d98082774700220439883fcad68f50014c824e311760b3d48708406153d57fe0a94f7a5deb3e1c101210242e1461aa67a0c21ba4ed65eec81b1ee3f9460cac030f3b9e0cd1da748c4ac01ffffffff0157e0673c000000001976a914dde900f38b45dad3718944fc7e949482d43e76f788ac8266385c000000000000000000000000000000"
```

[11-Jan-19 10:17 AM] lukechilds#2707
but I'm getting the end 38 chars (19 bytes)

[11-Jan-19 10:18 AM] lukechilds#2707
which doesn't quite match what you said previously about:

```
hashOutputs (32-byte hash)
nLockTime of the transaction (4-byte little endian)
nExpiryHeight of the transaction (4-byte little endian)
valueBalance of the transaction (8-byte little endian)
```

Which would imply I should be working with the last 32 chars (16 bytes)

[11-Jan-19 10:24 AM] lukechilds#2707
ah wait, I'm an idiot, my function doesn't even work

[11-Jan-19 10:24 AM] lukechilds#2707
after running a TX through my function I get:

```
An error occured:
16: mandatory-script-verify-flag-failed (Script evaluated without error but finished with a false/empty top stack element). Code:-26
```

[11-Jan-19 10:25 AM] jorian#4555
i think you forgot to do endianness correct

[11-Jan-19 10:25 AM] jorian#4555
5c386682 instead of 8266385c

[11-Jan-19 10:26 AM] jorian#4555
otherwise you'll be locking coins to GMT: Saturday, April 30, 2039 12:46:20 AM

[11-Jan-19 10:27 AM] lukechilds#2707
That gives the same error

[11-Jan-19 10:27 AM] jorian#4555
now i'm confused too

[11-Jan-19 10:27 AM] lukechilds#2707
and nLockTime has always been little endian (according to @ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢ s info â˜ ) so it should already be correct

[11-Jan-19 10:27 AM] lukechilds#2707
just the wrong position

[11-Jan-19 10:27 AM] jorian#4555
no you were right

[11-Jan-19 10:29 AM] jorian#4555
the unmangletransaction works?

[11-Jan-19 10:29 AM] lukechilds#2707
no it doesn't

[11-Jan-19 10:29 AM] lukechilds#2707
I get that error â˜

[11-Jan-19 10:29 AM] lukechilds#2707
But when @ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢ posted before saying to swap the bytes around, I copied his suggested end bytes, whacked them on the end of my TX, and it broadcacst

[11-Jan-19 10:30 AM] lukechilds#2707
so I'm not quite sure why that isn't working now

[11-Jan-19 10:31 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
When you make the initial raw tx, where is `8266385c` coming from?

[11-Jan-19 10:33 AM] jorian#4555
i think that last part is correct though, maybe something else in the transaction is wrong?

[11-Jan-19 10:34 AM] jorian#4555
```
8266385c000000000000000000000000000000
9e6d385c000000000000000000000000000000``` top one is yours, lower one mine.

[11-Jan-19 10:38 AM] lukechilds#2707
I had assumed that was nLockTime

[11-Jan-19 10:38 AM] lukechilds#2707
all the signing is happening on the device

[11-Jan-19 10:38 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
8266385c = 5c826638 = 1552049720 = GMT: Friday, March 8, 2019 12:55:20 PM

[11-Jan-19 10:38 AM] jorian#4555
eh no

[11-Jan-19 10:39 AM] jorian#4555
5c386682

[11-Jan-19 10:40 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
ok, my bad, no â˜• yet jorian is right

[11-Jan-19 10:40 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
so that bit is "right"

[11-Jan-19 10:40 AM] jorian#4555
maybe it is too far in history?

[11-Jan-19 10:40 AM] lukechilds#2707
it should be unixtime - 777

[11-Jan-19 10:40 AM] jorian#4555
i'm not sure what the boundaries are for setting locktime

[11-Jan-19 10:40 AM] lukechilds#2707
that was working previously

[11-Jan-19 10:41 AM] lukechilds#2707
unless the overwinter updates have broken how the ledger is calculating the nLockTime bytes

[11-Jan-19 10:41 AM] lukechilds#2707
which is quite possible

[11-Jan-19 10:41 AM] jorian#4555
do you have a txid and vout?

[11-Jan-19 10:41 AM] jorian#4555
or are there too many

[11-Jan-19 10:41 AM] lukechilds#2707
boundries are ~ 1 hour in the past

[11-Jan-19 10:41 AM] lukechilds#2707
The input data is 100% correct

[11-Jan-19 10:42 AM] lukechilds#2707
it's a bug in Ledger's new KMD overwinter upgrade

[11-Jan-19 10:42 AM] lukechilds#2707
if I don't set nLockTime, it creates a valid TX

[11-Jan-19 10:42 AM] lukechilds#2707
if I pass an nLockTime timestamp to the ledger lib

[11-Jan-19 10:42 AM] lukechilds#2707
the device creates a mangled transaction

[11-Jan-19 10:42 AM] lukechilds#2707
so I'm sure the input data is correct

[11-Jan-19 10:43 AM] lukechilds#2707
it's just a case of manually unmangling the TX bytes until Ledger fix it on their end

[11-Jan-19 10:43 AM] lukechilds#2707
which @ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢ successfully did for me before

[11-Jan-19 10:44 AM] lukechilds#2707
but the app has changed since then so it might be doing other weird stuff now

[11-Jan-19 10:46 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
the `mandatory-script-verify-flag-failed` error is coming to you from what? an attempt to sign?

[11-Jan-19 10:50 AM] lukechilds#2707
no an attempt to broadcast

[11-Jan-19 10:50 AM] lukechilds#2707
the Ledger signs without error

[11-Jan-19 10:51 AM] lukechilds#2707
but is obviously doing something wrong internally without realising

[11-Jan-19 11:08 AM] ComputerGenie ğŸ‘´ğŸ¼ğŸ“¢#7004
@lukechilds what does the raw tx look like before you sign it?

[11-Jan-19 11:37 AM] lukechilds#2707
There is none

